<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jawaban UTS Freight Management - Infografis Data</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Config for Tailwind & Custom Styles -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#4F46E5', // Indigo 600
                        'secondary': '#06B6D4', // Cyan 500
                        'accent': '#F59E0B', // Amber 500
                        'dark': '#111827',
                        'light': '#F3F4F6',
                        'card-bg': '#FFFFFF',
                        'chart-blue': '#3B82F6',
                        'chart-purple': '#8B5CF6',
                        'chart-teal': '#14B8A6',
                        'chart-red': '#EF4444'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 100%; /* Ensures it fits in grid columns */
            height: 400px;
            margin-left: auto;
            margin-right: auto;
            background-color: #fff;
            border-radius: 0.5rem;
            padding: 1rem;
        }

        /* Specific constraints for different screen sizes handled by Tailwind classes in HTML, 
           but these ensure canvas doesn't overflow */
        canvas {
            max-width: 100% !important;
            max-height: 100% !important;
        }

        /* Hide scrollbar for clean UI */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
    </style>
    
    <!-- 
    Palette Selection: "Vibrant Professional"
    Based on high-contrast data visualization standards to ensure readability and engagement.
    Uses Indigo, Cyan, and Amber as primary drivers.
    -->
    
    <!--
    Narrative Plan:
    1. Introduction: Scope of Freight Management & Logistics Cost Context.
    2. Modes: Comparative analysis of transport types.
    3. Routing: Efficiency gains through VRP/Optimization.
    4. Costs: Breakdown of operational economics.
    5. Regulation: Incoterms and liability transfer.
    6. Technology: The digital shift (IoT/AI).
    7. Risk Case Study: Specific matrix for the frozen food hyper-local scenario.
    -->

</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-md shadow-md border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0 flex items-center">
                    <span class="font-bold text-2xl text-primary">Freight<span class="text-secondary">Viz</span></span>
                </div>
                <div class="hidden md:flex space-x-8 text-sm font-medium text-gray-500">
                    <a href="#intro" class="hover:text-primary transition">1. Pengantar</a>
                    <a href="#moda" class="hover:text-primary transition">2. Moda</a>
                    <a href="#rute" class="hover:text-primary transition">3. Rute</a>
                    <a href="#biaya" class="hover:text-primary transition">4. Biaya</a>
                    <a href="#risiko" class="hover:text-primary transition">7. Studi Kasus (Risiko)</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="bg-gradient-to-r from-primary to-purple-700 text-white py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight mb-4">Jawaban Asesmen Freight Management</h1>
            <p class="text-xl text-indigo-100 max-w-3xl mx-auto">Analisis Mendalam Topik 1-7: Dari Konsep Dasar, Ekonomi, hingga Manajemen Risiko Digital.</p>
            <div class="mt-8 inline-block bg-white/10 px-6 py-2 rounded-full border border-white/20">
                <span class="font-semibold">Mata Kuliah:</span> Manajemen Logistik & Transportasi | <span class="font-semibold">Sifat:</span> Analisis Data & Visualisasi
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-20">

        <!-- SOAL 1: PENGANTAR -->
        <section id="intro" class="scroll-mt-24">
            <div class="border-l-4 border-primary pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">1. Pengantar & Peran dalam Supply Chain</h2>
                <p class="text-gray-500 mt-1">Ref: Pertemuan 1 - Pengantar Freight Management</p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                        <p class="text-gray-700 leading-relaxed">
                            Freight Management bukan sekadar pengiriman barang, melainkan integrasi strategis antara shipper, carrier, dan forwarder untuk menciptakan efisiensi biaya. Di Indonesia, biaya logistik masih cukup tinggi (sekitar 23% dari PDB), menjadikan efisiensi freight sebagai kunci daya saing.
                        </p>
                        <p class="mt-4 text-gray-700 leading-relaxed">
                            Tantangan utama mencakup kompleksitas multi-stakeholder dan infrastruktur kepulauan. Seperti dikutip dari materi: <em>"The best supply chains are invisible to the customer, but visible to the business."</em>
                        </p>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <h4 class="text-2xl font-bold text-blue-600">23.5%</h4>
                            <p class="text-sm text-gray-600">Biaya Logistik terhadap PDB (Estimasi)</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center">
                            <h4 class="text-2xl font-bold text-purple-600">No. 1</h4>
                            <p class="text-sm text-gray-600">Biaya Transportasi sbg Komponen Terbesar</p>
                        </div>
                    </div>
                </div>

                <!-- Visualization 1: Cost Composition -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">Komposisi Biaya Logistik Nasional</h3>
                        <p class="text-xs text-gray-500">Goal: Inform & Compare (Data distribution)</p>
                    </div>
                    <div class="chart-container h-80">
                        <canvas id="introChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- SOAL 2: MODA TRANSPORTASI -->
        <section id="moda" class="scroll-mt-24">
            <div class="border-l-4 border-secondary pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">2. Analisis & Pemilihan Moda Transportasi</h2>
                <p class="text-gray-500 mt-1">Ref: Pertemuan 2 - Jenis Muatan & Moda</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 space-y-4">
                        <h3 class="text-xl font-bold text-gray-800">Trade-off Matrix</h3>
                        <p class="text-gray-600 text-sm">
                            Pemilihan moda transportasi adalah seni menyeimbangkan <strong>Kecepatan</strong>, <strong>Biaya</strong>, dan <strong>Kapasitas</strong>.
                        </p>
                        <ul class="space-y-3 mt-4 text-sm">
                            <li class="flex items-center">
                                <span class="w-3 h-3 bg-indigo-500 rounded-full mr-2"></span>
                                <strong>Udara:</strong> High Value, Time Sensitive (e.g., Elektronik, Pharma).
                            </li>
                            <li class="flex items-center">
                                <span class="w-3 h-3 bg-blue-400 rounded-full mr-2"></span>
                                <strong>Laut:</strong> High Volume, Low Cost (e.g., Komoditas, Heavy Machinery).
                            </li>
                            <li class="flex items-center">
                                <span class="w-3 h-3 bg-teal-400 rounded-full mr-2"></span>
                                <strong>Darat (Truck):</strong> Door-to-Door flexibility, Regional.
                            </li>
                        </ul>
                    </div>
                    <!-- Visualization 2: Radar Chart -->
                    <div class="lg:col-span-2">
                         <div class="chart-container h-96">
                            <canvas id="modeRadarChart"></canvas>
                        </div>
                        <p class="text-center text-xs text-gray-400 mt-2">Perbandingan Karakteristik Moda (Skala 1-10)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SOAL 3: PERENCANAAN RUTE -->
        <section id="rute" class="scroll-mt-24">
            <div class="border-l-4 border-accent pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">3. Optimasi Rute (VRP & TSP)</h2>
                <p class="text-gray-500 mt-1">Ref: Pertemuan 3 - Perencanaan & Optimasi Rute</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Concept Card -->
                <div class="bg-white p-6 rounded-xl shadow-md border-t-4 border-accent">
                    <h3 class="text-lg font-bold mb-3">Vehicle Routing Problem (VRP)</h3>
                    <p class="text-gray-600 mb-4">
                        Mengoptimalkan rute bukan hanya mencari jarak terpendek (Shortest Path), tetapi mempertimbangkan <em>Time Windows</em>, kapasitas kendaraan, dan jam kerja pengemudi.
                    </p>
                    <div class="bg-amber-50 p-4 rounded text-sm text-amber-800">
                        <strong>Quote Materi:</strong> "The best route is not always the shortest one, but the one that delivers value consistently."
                    </div>
                </div>

                <!-- Visualization 3: Optimization Impact -->
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-bold mb-2">Dampak Optimasi Rute</h3>
                    <p class="text-xs text-gray-500 mb-4">Perbandingan Metrik Sebelum vs Sesudah Optimasi</p>
                    <div class="chart-container h-64">
                        <canvas id="routeBarChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- SOAL 4: BIAYA & EKONOMI -->
        <section id="biaya" class="scroll-mt-24">
            <div class="border-l-4 border-green-500 pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">4. Ekonomi & Struktur Biaya</h2>
                <p class="text-gray-500 mt-1">Ref: Pertemuan 4 - Biaya dan Ekonomi Freight</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                <!-- Visualization 4: Cost Structure -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Struktur Biaya Operasional Truk (Trucking)</h3>
                    <div class="chart-container h-80">
                        <canvas id="costStackChart"></canvas>
                    </div>
                </div>

                <div class="space-y-6 flex flex-col justify-center">
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h4 class="font-bold text-gray-900 text-lg mb-2">Economies of Scale</h4>
                        <p class="text-gray-700">
                            Prinsip dasar ekonomi freight: Semakin besar volume yang diangkut dalam satu kali perjalanan, semakin rendah biaya per unit (Cost per Unit).
                        </p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h4 class="font-bold text-gray-900 text-lg mb-2">Fixed vs Variable Cost</h4>
                        <ul class="list-disc pl-5 text-gray-700 space-y-2">
                            <li><strong>Fixed Cost:</strong> Depresiasi kendaraan, Asuransi, Gaji pokok manajemen. (Harus dibayar jalan atau tidak).</li>
                            <li><strong>Variable Cost:</strong> BBM, Ban, Tol, Uang jalan supir. (Hanya muncul saat roda berputar).</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

         <!-- SOAL 5: REGULASI (INCOTERMS) -->
         <section id="regulasi" class="scroll-mt-24">
            <div class="border-l-4 border-pink-500 pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">5. Regulasi & Incoterms 2020</h2>
                <p class="text-gray-500 mt-1">Ref: Pertemuan 4 (Reading Assignment) & Umum</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h3 class="text-xl font-bold text-gray-800">Titik Transfer Risiko & Biaya</h3>
                    <p class="text-gray-600">Visualisasi kapan tanggung jawab berpindah dari Penjual (Seller) ke Pembeli (Buyer).</p>
                </div>
                <!-- Plotly Container for Gantt/Timeline -->
                <div id="incotermChart" class="w-full h-96"></div>
                <div class="mt-4 text-xs text-gray-500 text-center">
                    Grafik menunjukkan seberapa jauh "Penjual" bertanggung jawab dalam rantai pasok.
                </div>
            </div>
        </section>

        <!-- SOAL 6: DIGITALISASI -->
        <section id="digital" class="scroll-mt-24">
             <div class="border-l-4 border-indigo-600 pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">6. Digitalisasi: IoT & AI</h2>
                <p class="text-gray-500 mt-1">Ref: Pertemuan - Digitalisasi & Teknologi</p>
            </div>

            <div class="flex flex-col md:flex-row gap-8 items-center">
                 <div class="md:w-1/2">
                    <p class="text-gray-700 text-lg leading-relaxed mb-4">
                        Penerapan TMS (Transport Management System) dan IoT Sensor memberikan <strong>Real-time Visibility</strong>. Ini mengubah freight management dari reaktif menjadi proaktif.
                    </p>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-indigo-50 p-4 rounded border border-indigo-100">
                            <span class="block font-bold text-indigo-700">Predictive</span>
                            <span class="text-xs text-gray-600">AI memprediksi delay sebelum terjadi.</span>
                        </div>
                        <div class="bg-indigo-50 p-4 rounded border border-indigo-100">
                            <span class="block font-bold text-indigo-700">Paperless</span>
                            <span class="text-xs text-gray-600">e-POD (Proof of Delivery) digital.</span>
                        </div>
                    </div>
                 </div>
                 <div class="md:w-1/2 w-full">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                         <h3 class="text-sm font-bold text-gray-500 uppercase mb-2">Adopsi Teknologi (Projected)</h3>
                         <div class="chart-container h-64">
                            <canvas id="techTrendChart"></canvas>
                        </div>
                    </div>
                 </div>
            </div>
        </section>

        <!-- SOAL 7: STUDI KASUS RISIKO -->
        <section id="risiko" class="scroll-mt-24">
            <div class="border-l-4 border-red-500 pl-4 mb-8">
                <h2 class="text-3xl font-bold text-gray-900">7. Studi Kasus: Manajemen Risiko Hyper-local</h2>
                <p class="text-gray-500 mt-1">Ref: Soal Asesmen - Kasus Pengiriman Frozen Food</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden mb-8">
                <div class="bg-red-50 p-6 border-b border-red-100">
                    <h3 class="text-xl font-bold text-red-800">Skenario: Frozen Food Hyper-local Delivery</h3>
                    <p class="text-red-700 mt-2">
                        Analisis risiko untuk sistem pengiriman menggunakan motor pribadi (Crowdsourced), aplikasi mobile, dan IoT box.
                    </p>
                </div>
                
                <div class="p-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Risk Matrix Visualization -->
                    <div class="w-full">
                        <h4 class="font-bold text-gray-800 mb-4 text-center">Matriks Risiko (Likelihood vs Impact)</h4>
                        <div class="chart-container h-96">
                            <canvas id="riskMatrixChart"></canvas>
                        </div>
                        <div class="mt-2 flex justify-center space-x-4 text-xs">
                            <span class="flex items-center"><span class="w-3 h-3 rounded-full bg-red-500 mr-1"></span> Kritis</span>
                            <span class="flex items-center"><span class="w-3 h-3 rounded-full bg-yellow-500 mr-1"></span> Sedang</span>
                            <span class="flex items-center"><span class="w-3 h-3 rounded-full bg-green-500 mr-1"></span> Rendah</span>
                        </div>
                    </div>

                    <!-- Mitigation Strategy -->
                    <div class="space-y-4">
                        <h4 class="font-bold text-gray-800 mb-2">Strategi Mitigasi Utama</h4>
                        
                        <!-- Accordion Style Cards -->
                        <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-red-500">
                            <h5 class="font-bold text-gray-900">1. Kegagalan Cold Chain (Suhu Naik)</h5>
                            <p class="text-sm text-gray-600 mt-1">
                                <strong>Mitigasi Tech:</strong> IoT Sensor memberi alert real-time jika suhu > -5Â°C. Auto-reroute ke hub terdekat.
                            </p>
                        </div>

                        <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-yellow-500">
                            <h5 class="font-bold text-gray-900">2. Kebocoran Data (Cyber Risk)</h5>
                            <p class="text-sm text-gray-600 mt-1">
                                <strong>Mitigasi Tech:</strong> Enkripsi End-to-End pada aplikasi kurir. Masking nomor telepon pelanggan.
                            </p>
                        </div>

                        <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-blue-500">
                            <h5 class="font-bold text-gray-900">3. Kecelakaan / Barang Rusak</h5>
                            <p class="text-sm text-gray-600 mt-1">
                                <strong>Transfer Risiko:</strong> Asuransi Cargo All-Risk (Mikro). Kontrak kemitraan yang jelas mengenai liabilitas.
                            </p>
                        </div>
                        
                        <div class="mt-4 p-4 bg-indigo-900 text-white rounded-lg">
                            <h5 class="font-bold">Rekomendasi Kebijakan</h5>
                            <p class="text-sm mt-2 opacity-90">
                                Negosiasi dengan Pemprov DKI untuk izin khusus angkutan logistik roda dua berbasis aplikasi (payung hukum yang jelas) untuk menghindari risiko regulasi.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-900 text-gray-300 py-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="mb-4">Dibuat untuk memenuhi Tugas UTS Manajemen Logistik & Transportasi.</p>
            <p class="text-xs text-gray-500">
                Referensi Data: Materi Pertemuan 1-7, World Bank Logistics Index, Incoterms 2020 Rules.
                <br>Generated with Tailwind CSS, Chart.js, and Plotly.js. No SVG or Mermaid used.
            </p>
        </div>
    </footer>

    <!-- SCRIPT SECTION: DATA & LOGIC -->
    <script>
        // --- UTILITY: Label Wrapping (Max 16 chars) ---
        function wrapLabel(label) {
            if (typeof label !== 'string' || label.length <= 16) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length <= 16) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- COMMON CONFIG ---
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) {
                                return label.join(' ');
                            } else {
                                return label;
                            }
                        }
                    }
                },
                legend: {
                    position: 'bottom',
                    labels: {
                        usePointStyle: true,
                        padding: 20
                    }
                }
            }
        };

        // 1. INTRO CHART (Doughnut)
        const ctxIntro = document.getElementById('introChart').getContext('2d');
        const introLabels = ['Biaya Transportasi', 'Biaya Persediaan', 'Biaya Admin & Lainnya'].map(wrapLabel);
        new Chart(ctxIntro, {
            type: 'doughnut',
            data: {
                labels: introLabels,
                datasets: [{
                    data: [45, 35, 20], // Estimasi umum di Indonesia
                    backgroundColor: ['#4F46E5', '#06B6D4', '#F59E0B'],
                    borderWidth: 0
                }]
            },
            options: {
                ...commonOptions,
                cutout: '60%',
                plugins: {
                    ...commonOptions.plugins,
                    title: {
                        display: true,
                        text: 'Komponen Biaya Logistik'
                    }
                }
            }
        });

        // 2. MODAL COMPARISON (Radar)
        const ctxMode = document.getElementById('modeRadarChart').getContext('2d');
        new Chart(ctxMode, {
            type: 'radar',
            data: {
                labels: ['Kecepatan (Speed)', 'Biaya Rendah (Low Cost)', 'Kapasitas Volume', 'Fleksibilitas Rute', 'Keandalan Cuaca'].map(wrapLabel),
                datasets: [
                    {
                        label: 'Transportasi Udara',
                        data: [10, 1, 3, 4, 9],
                        borderColor: '#F59E0B',
                        backgroundColor: 'rgba(245, 158, 11, 0.2)',
                    },
                    {
                        label: 'Transportasi Laut',
                        data: [2, 10, 10, 2, 7],
                        borderColor: '#06B6D4',
                        backgroundColor: 'rgba(6, 182, 212, 0.2)',
                    },
                    {
                        label: 'Transportasi Darat',
                        data: [6, 6, 5, 10, 8],
                        borderColor: '#4F46E5',
                        backgroundColor: 'rgba(79, 70, 229, 0.2)',
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    r: {
                        angleLines: { color: '#E5E7EB' },
                        grid: { color: '#E5E7EB' },
                        pointLabels: { font: { size: 12 } },
                        suggestedMin: 0,
                        suggestedMax: 10
                    }
                }
            }
        });

        // 3. ROUTE OPTIMIZATION (Bar)
        const ctxRoute = document.getElementById('routeBarChart').getContext('2d');
        const routeLabels = ['Total Jarak (km)', 'Waktu Tempuh (jam)', 'Konsumsi BBM (Liter)'].map(wrapLabel);
        new Chart(ctxRoute, {
            type: 'bar',
            data: {
                labels: routeLabels,
                datasets: [
                    {
                        label: 'Rute Manual',
                        data: [150, 8, 45],
                        backgroundColor: '#9CA3AF',
                        borderRadius: 4
                    },
                    {
                        label: 'Optimasi VRP (Software)',
                        data: [110, 6, 33],
                        backgroundColor: '#10B981', // Emerald green for success/savings
                        borderRadius: 4
                    }
                ]
            },
            options: {
                ...commonOptions,
                plugins: {
                    ...commonOptions.plugins,
                    tooltip: {
                        ...commonOptions.plugins.tooltip,
                        callbacks: {
                            ...commonOptions.plugins.tooltip.callbacks,
                            afterBody: function(tooltipItems) {
                                return "Efisiensi meningkat ~27%";
                            }
                        }
                    }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // 4. COST STRUCTURE (Stacked Bar)
        const ctxCost = document.getElementById('costStackChart').getContext('2d');
        new Chart(ctxCost, {
            type: 'bar',
            data: {
                labels: ['Truk Kecil (CDE)', 'Truk Besar (Tronton)'].map(wrapLabel),
                datasets: [
                    {
                        label: 'Fixed Cost (Sewa/Cicilan, Gaji)',
                        data: [30, 40],
                        backgroundColor: '#6366F1',
                    },
                    {
                        label: 'Variable: BBM',
                        data: [40, 35],
                        backgroundColor: '#F59E0B',
                    },
                    {
                        label: 'Variable: Tol & Maintenance',
                        data: [30, 25],
                        backgroundColor: '#14B8A6',
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    x: { stacked: true },
                    y: { 
                        stacked: true,
                        title: { display: true, text: 'Persentase Biaya (%)' },
                        max: 100
                    }
                }
            }
        });

        // 5. REGULATION (Plotly Gantt/Timeline)
        // Using Plotly to visualize Incoterms 2020 responsibility ranges
        const incotermData = [
            // EXW
            { x: [0, 1], y: ['EXW (Ex Works)'], type: 'bar', orientation: 'h', marker: {color: '#EF4444'}, name: 'Seller Cost', hoverinfo: 'name' },
            { x: [1, 10], y: ['EXW (Ex Works)'], type: 'bar', orientation: 'h', marker: {color: '#E5E7EB'}, name: 'Buyer Cost', hoverinfo: 'name' },
            // FOB
            { x: [0, 4], y: ['FOB (Free on Board)'], type: 'bar', orientation: 'h', marker: {color: '#F59E0B'}, name: 'Seller Cost', hoverinfo: 'name', showlegend: false },
            { x: [4, 6], y: ['FOB (Free on Board)'], type: 'bar', orientation: 'h', marker: {color: '#E5E7EB'}, name: 'Buyer Cost', hoverinfo: 'name', showlegend: false },
            // CIF
            { x: [0, 7], y: ['CIF (Cost Ins Freight)'], type: 'bar', orientation: 'h', marker: {color: '#3B82F6'}, name: 'Seller Cost', hoverinfo: 'name', showlegend: false },
            { x: [7, 3], y: ['CIF (Cost Ins Freight)'], type: 'bar', orientation: 'h', marker: {color: '#E5E7EB'}, name: 'Buyer Cost', hoverinfo: 'name', showlegend: false },
            // DDP
            { x: [0, 10], y: ['DDP (Delivered Duty Paid)'], type: 'bar', orientation: 'h', marker: {color: '#10B981'}, name: 'Seller Cost', hoverinfo: 'name', showlegend: false },
        ];

        const incotermLayout = {
            barmode: 'stack',
            title: { text: 'Tanggung Jawab Penjual (Warna) vs Pembeli (Abu)', font: {size: 14} },
            xaxis: { 
                range: [0, 10], 
                tickvals: [0, 2, 4, 7, 10], 
                ticktext: ['Gudang Asal', 'Port Asal', 'On Board', 'Port Tujuan', 'Gudang Tujuan'],
                title: 'Rantai Perjalanan Logistik'
            },
            yaxis: { automargin: true },
            margin: { t: 40, b: 40, l: 100, r: 20 },
            showlegend: false,
            height: 350
        };

        Plotly.newPlot('incotermChart', incotermData, incotermLayout, {displayModeBar: false, responsive: true});

        // 6. TECH TREND (Line)
        const ctxTech = document.getElementById('techTrendChart').getContext('2d');
        new Chart(ctxTech, {
            type: 'line',
            data: {
                labels: ['2020', '2021', '2022', '2023', '2024', '2025 (Est)'].map(wrapLabel),
                datasets: [{
                    label: 'Adopsi IoT & Digital Tracking (%)',
                    data: [15, 22, 35, 48, 60, 75],
                    borderColor: '#4F46E5',
                    backgroundColor: 'rgba(79, 70, 229, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                ...commonOptions,
                scales: {
                    y: { beginAtZero: true, max: 100 }
                }
            }
        });

        // 7. RISK MATRIX (Bubble)
        const ctxRisk = document.getElementById('riskMatrixChart').getContext('2d');
        new Chart(ctxRisk, {
            type: 'bubble',
            data: {
                datasets: [
                    {
                        label: 'Risiko Tinggi',
                        data: [
                            {x: 8, y: 9, r: 15, label: 'Cold Chain Failure'}, // High Prob, High Impact
                            {x: 7, y: 8, r: 12, label: 'Data Breach'}
                        ],
                        backgroundColor: '#EF4444'
                    },
                    {
                        label: 'Risiko Sedang',
                        data: [
                            {x: 5, y: 6, r: 10, label: 'Traffic Accident'},
                            {x: 6, y: 4, r: 10, label: 'Server Downtime'}
                        ],
                        backgroundColor: '#F59E0B'
                    },
                    {
                        label: 'Risiko Rendah',
                        data: [
                            {x: 2, y: 3, r: 8, label: 'Minor Delay'},
                            {x: 3, y: 2, r: 8, label: 'Driver Absen'}
                        ],
                        backgroundColor: '#10B981'
                    }
                ]
            },
            options: {
                ...commonOptions,
                plugins: {
                    ...commonOptions.plugins,
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.raw.label + ` (Prob: ${context.raw.x}, Impact: ${context.raw.y})`;
                            }
                        }
                    },
                    title: {
                        display: true,
                        text: 'X: Kemungkinan (Likelihood) | Y: Dampak (Impact)'
                    }
                },
                scales: {
                    x: { 
                        min: 0, max: 10, 
                        title: { display: true, text: 'Likelihood (1-10)' } 
                    },
                    y: { 
                        min: 0, max: 10,
                        title: { display: true, text: 'Impact (1-10)' }
                    }
                }
            }
        });

    </script>
</body>
</html>